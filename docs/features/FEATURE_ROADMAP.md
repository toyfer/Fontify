# Fontify 機能追加ロードマップ

## 概要
このドキュメントは、Fontify拡張機能の今後の機能追加計画を詳細に記載しています。優先度と実装の複雑さに基づいて機能を分類し、開発の指針を提供します。

## 現在の機能

### 実装済み機能
- ✅ WebフォントURLによるフォント置換
- ✅ 除外URLリスト管理
- ✅ ポップアップからの除外リスト追加
- ✅ フォントファイルキャッシュ機能
- ✅ Chrome/Firefox両対応（Manifest V3）
- ✅ Bulma CSSによるモダンUI

## 計画機能

### 優先度: 高 (短期実装: 1-2ヶ月)

#### 1. フォントプレビュー機能
**説明**: フォント適用前にプレビューを表示
**実装内容**:
- オプションページにサンプルテキストプレビュー
- リアルタイムフォント切り替え表示
- 複数のサンプル文字（英数字、ひらがな、カタカナ、漢字）

**技術的考慮**:
```javascript
// プレビュー表示の実装例
function updateFontPreview(fontUrl) {
  const previewElement = document.getElementById('fontPreview');
  previewElement.style.fontFamily = `url('${fontUrl}'), sans-serif`;
}
```

#### 2. フォントプリセット管理
**説明**: 複数のフォント設定を保存・切り替え
**実装内容**:
- 名前付きフォントプリセット保存
- プリセット一覧表示・選択
- デフォルトプリセット設定

**ストレージ構造**:
```json
{
  "fontPresets": [
    {
      "name": "ゴシック",
      "fontUrl": "https://fonts.googleapis.com/css2?family=Noto+Sans+JP",
      "excludeUrls": ["example.com"]
    }
  ],
  "activePreset": "ゴシック"
}
```

#### 3. 改善されたエラーハンドリング
**説明**: フォント読み込み失敗時の適切な処理
**実装内容**:
- フォントURL検証機能
- 読み込み失敗時のフォールバック
- ユーザーへの明確なエラーメッセージ

### 優先度: 中 (中期実装: 2-4ヶ月)

#### 4. Google Fonts API統合
**説明**: Google Fontsを直接検索・選択可能に
**実装内容**:
- Google Fonts APIから一覧取得
- フォント検索機能
- カテゴリ別フィルタリング

#### 5. サイト別フォント設定
**説明**: ドメインごとに異なるフォント設定
**実装内容**:
- ドメイン別ルール設定
- 優先度付きルール適用
- 正規表現パターンマッチング

**データ構造**:
```json
{
  "siteSpecificRules": [
    {
      "pattern": "*.github.com",
      "fontUrl": "coding-font.woff2",
      "priority": 1
    }
  ]
}
```

#### 6. フォント調整オプション
**説明**: フォントサイズ・太さの調整機能
**実装内容**:
- フォントサイズ倍率設定
- フォントウェイト調整
- 行間調整オプション

#### 7. ダークモード対応
**説明**: UIのダークモード切り替え
**実装内容**:
- オプションページダークモード
- ポップアップダークモード
- システム設定連動

### 優先度: 低 (長期実装: 4-6ヶ月)

#### 8. 設定インポート・エクスポート
**説明**: 設定の外部ファイル保存・読み込み
**実装内容**:
- JSON形式での設定エクスポート
- 設定ファイルインポート機能
- 設定の部分的マージ

#### 9. パフォーマンス最適化
**説明**: 拡張機能の動作速度向上
**実装内容**:
- フォント読み込み最適化
- キャッシュ戦略改善
- メモリ使用量削減

#### 10. 詳細統計機能
**説明**: フォント使用状況の分析
**実装内容**:
- フォント適用回数統計
- サイト別使用頻度
- パフォーマンスメトリクス

#### 11. キーボードショートカット
**説明**: キーボードによる機能操作
**実装内容**:
- フォント切り替えショートカット
- 除外リスト追加ショートカット
- 設定画面表示ショートカット

### 技術的改善項目

#### A. アーキテクチャ改善
- モジュール化されたコード構造
- TypeScript導入検討
- 単体テスト追加

#### B. セキュリティ強化
- CSP（Content Security Policy）準拠
- フォントURL検証強化
- XSS攻撃対策

#### C. 互換性向上
- 古いブラウザバージョン対応
- 異なるサイト構造への対応
- モバイルブラウザ対応検討

## 実装スケジュール

### Phase 1 (1-2ヶ月): 基本UX改善
- フォントプレビュー機能
- フォントプリセット管理
- エラーハンドリング改善

### Phase 2 (2-4ヶ月): 高度な機能
- Google Fonts API統合
- サイト別フォント設定
- フォント調整オプション
- ダークモード対応

### Phase 3 (4-6ヶ月): 高度な機能と最適化
- 設定インポート・エクスポート
- パフォーマンス最適化
- 詳細統計機能
- キーボードショートカット

## 開発上の注意点

### 1. ブラウザ互換性
- Chrome/Firefox両対応の維持
- Manifest V3準拠の継続
- 新しいAPI使用時の fallback 実装

### 2. パフォーマンス
- フォント読み込み速度の最適化
- メモリ使用量の監視
- CPU使用率の制限

### 3. ユーザビリティ
- 直感的なUI設計
- アクセシビリティ対応
- 多言語サポート検討

### 4. セキュリティ
- 外部リソース読み込みの安全性
- ユーザーデータ保護
- 権限の最小化

## 成功指標

### 短期目標
- ユーザー満足度向上
- 設定完了率の向上
- エラー発生率の削減

### 長期目標
- アクティブユーザー数増加
- 拡張機能レビュー評価向上
- コミュニティ貢献者増加

## まとめ

このロードマップは、Fontify拡張機能を段階的に改善し、ユーザーエクスペリエンスを向上させるための計画です。優先度に基づいて実装を進めることで、効率的な開発と安定したリリースを実現できます。

定期的にロードマップを見直し、ユーザーフィードバックや技術的な変化に応じて調整していくことが重要です。